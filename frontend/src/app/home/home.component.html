<div class="home">
  <banner />

  <div class="modular-card">
    <div class="home-content">
      <div class="latest-blog">
        <h2>LATEST BLOG POST</h2>
        <div *ngIf="latestBlogPost; else noBlogPost" (click)="navigateToBlogPost(latestBlogPost.id)" class="clickable-card">
          <h3>{{ latestBlogPost.title }}</h3>
          <p class="blog-meta">By {{ latestBlogPost.author }} | {{ formatDate(latestBlogPost.publish_date) }}</p>
          <p>{{ truncateContent(latestBlogPost.content, 150) }}</p>
        </div>
        <ng-template #noBlogPost>
          <p>No recent blog posts available.</p>
        </ng-template>
      </div>

      <div class="latest-song">
        <h2>LATEST PLAYED SONG</h2>
        <div *ngIf="latestPlayedSong; else noSong">
          <h3>{{ latestPlayedSong.title }}</h3>
          <p><strong>Artist:</strong> {{ latestPlayedSong.artist }}</p>
          <p *ngIf="latestPlayedSong.album"><strong>Album:</strong> {{ latestPlayedSong.album }}</p>
          <p class="song-meta">Played by {{ latestPlayedSong.dj_name }} | {{ formatPlayTime(latestPlayedSong.played_at) }}</p>
        </div>
        <ng-template #noSong>
          <p>No recent songs available.</p>
        </ng-template>
      </div>

      <div class="latest-playlist">
        <h2>LATEST PLAYLIST</h2>
        <div *ngIf="latestPlaylist; else noPlaylist" (click)="navigateToPlaylist(latestPlaylist.id)" class="clickable-card">
          <h3>{{ latestPlaylist.name || 'Unnamed Playlist' }}</h3>
          <p><strong>DJ:</strong> {{ latestPlaylist.dj_name }}</p>
          <p *ngIf="latestPlaylist.description">{{ latestPlaylist.description }}</p>
          <p class="playlist-meta">{{ formatDate(latestPlaylist.date_played) }}<span *ngIf="latestPlaylist.track_count"> | {{ latestPlaylist.track_count }} tracks</span></p>
        </div>
        <ng-template #noPlaylist>
          <p>No recent playlists available.</p>
        </ng-template>
      </div>
    </div>
  </div>

  <!-- Featured Playlist Section -->
  <div class="modular-card">
    <h2>Featured Playlist</h2>
    <div class="spotify-playlist-card">
      <div class="playlist-info">
        <div class="playlist-cover">
          <div class="play-icon">▶</div>
        </div>
        <div class="playlist-details">
          <h3 class="playlist-title">KMNR Weekly Mix</h3>
          <p class="playlist-description">The best tracks featured on KMNR this week</p>
          <p class="playlist-meta">30 songs • 2 hours</p>
        </div>
      </div>
      <div class="playlist-actions">
        <button class="spotify-btn" (click)="openSpotifyPlaylist()">
          <span class="spotify-icon">♫</span>
          Open in Spotify
        </button>
      </div>
    </div>
  </div>
</div>
