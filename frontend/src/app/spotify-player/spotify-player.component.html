<div class="spotify-player">
  <h2>Spotify Player</h2>

  <!-- Configuration Status -->
  <div class="status" *ngIf="!isConnected">
    <p>🎵 Connect to Spotify to start listening</p>
  </div>

  <!-- Login Section -->
  <div class="auth-section">
    <div *ngIf="!isConnected">
      <button (click)="connectSpotify()" class="connect-btn">
        🎵 Connect to Spotify
      </button>
      <p class="info">You'll need a Spotify Premium account for full playback control</p>
    </div>

    <div *ngIf="isConnected">
      <p>✅ Connected to Spotify!</p>
      <p *ngIf="userProfile">Welcome, {{ userProfile.display_name }}!</p>
      <button (click)="disconnect()" class="disconnect-btn">Disconnect</button>
    </div>
  </div>

  <!-- Search Section -->
  <div class="search-section" *ngIf="isConnected">
    <h3>🔍 Search Spotify</h3>
    <div class="search-controls">
      <input 
        #searchInput 
        (keyup.enter)="search(searchInput.value)" 
        placeholder="Search for songs, albums, artists..."
        class="search-input">
      <button (click)="search(searchInput.value)" class="search-btn">Search</button>
    </div>

    <!-- Search Results -->
    <div class="search-results" *ngIf="searchResults.length > 0">
      <h4>🎵 Songs</h4>
      <div class="results-list">
        <div class="result-item" *ngFor="let track of searchResults">
          <div class="track-info">
            <div class="track-details">
              <strong>{{ track.name }}</strong><br>
              <span class="artist">{{ track.artists[0]?.name }}</span><br>
              <span class="album" *ngIf="track.album">{{ track.album.name }}</span>
            </div>
          </div>
          <div class="track-actions">
            <button (click)="playTrack(track)" class="play-btn" *ngIf="hasSpotifyPremium">▶️ Play</button>
            <a [href]="track.external_urls.spotify" target="_blank" class="spotify-link">Open in Spotify</a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- User Playlists -->
  <div class="playlists-section" *ngIf="isConnected">
    <h3>📚 Your Playlists</h3>
    <button (click)="getUserPlaylists()" class="load-btn">Load My Playlists</button>

    <div class="playlists" *ngIf="userPlaylists.length > 0">
      <div class="playlist-item" *ngFor="let playlist of userPlaylists">
        <div class="playlist-info">
          <div class="playlist-details">
            <strong>{{ playlist.name }}</strong><br>
            <span class="track-count">{{ playlist.tracks.total }} tracks</span><br>
            <span class="owner" *ngIf="playlist.owner">by {{ playlist.owner.display_name }}</span>
          </div>
        </div>
        <div class="playlist-actions">
          <button (click)="playPlaylist(playlist)" class="play-btn" *ngIf="hasSpotifyPremium">▶️ Play</button>
          <a [href]="playlist.external_urls.spotify" target="_blank" class="spotify-link">Open in Spotify</a>
        </div>
      </div>
    </div>
  </div>

  <!-- Player Controls (for Premium users) -->
  <div class="player-controls" *ngIf="isConnected && hasSpotifyPremium">
    <h3>🎛️ Player Controls</h3>
    <p class="note">Make sure you have Spotify open on another device!</p>
    <div class="controls">
      <button (click)="previousTrack()" class="control-btn">⏮️ Previous</button>
      <button (click)="pausePlayback()" class="control-btn">⏸️ Pause</button>
      <button (click)="resumePlayback()" class="control-btn">▶️ Play</button>
      <button (click)="nextTrack()" class="control-btn">⏭️ Next</button>
    </div>
  </div>

  <!-- Current Playback -->
  <div class="current-playback" *ngIf="currentTrack">
    <h4>🎵 Now Playing</h4>
    <div class="current-track">
      <strong>{{ currentTrack.name }}</strong><br>
      <span>{{ currentTrack.artists[0]?.name }}</span>
    </div>
  </div>

  <!-- Error Messages -->
  <div class="error-message" *ngIf="errorMessage">
    ❌ {{ errorMessage }}
  </div>
</div>